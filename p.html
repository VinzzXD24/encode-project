<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Custom Obfuscator (Literal Strings Only)</title>
  <style>
    body {
      font-family: monospace;
      margin: 20px;
      background: #f4f4f4;
    }
    textarea, pre {
      width: 100%;
      box-sizing: border-box;
      padding: 10px;
      margin-bottom: 10px;
      font-size: 14px;
    }
    textarea { height: 200px; }
    pre { background: #e0e0e0; white-space: pre-wrap; }
    button {
      padding: 10px 15px;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Custom Obfuscator (Obfuscate Literal Strings Saja)</h1>
  <textarea id="inputCode" placeholder="Masukkan kode JavaScript di sini..."></textarea>
  <br>
  <button onclick="obfuscateCode()">Obfuscate</button>
  <h2>Output Code:</h2>
  <pre id="outputCode"></pre>

  <script>
    // Fungsi untuk menghasilkan nama acak dengan format _0xXXXXXX
    function generateRandomName() {
      let hex = Math.floor(Math.random() * 0x1000000).toString(16);
      hex = ('000000' + hex).slice(-6);
      return "_0x" + hex;
    }

    function obfuscateCode() {
      let input = document.getElementById("inputCode").value;
      if (!input.trim()) {
        alert("Masukkan kode terlebih dahulu!");
        return;
      }

      // Hasil akhir akan dibangun melalui tiga bagian:
      // 1. Deklarasi "dummy" dan fungsi pembantu dengan nama acak.
      // 2. Deklarasi array literal string (yang berisi string–string unik dari input).
      // 3. Kode input yang sudah diganti literal string-nya dengan referensi ke array.

      // Pertama, kumpulkan semua literal string pada kode.
      // Regex ini menangkap literal dengan tanda kutip tunggal, ganda, atau backtick.
      const stringRegex = /(["'`])(?:(?=(\\?))\2.)*?\1/g;
      const matches = input.match(stringRegex) || [];

      // Kumpulkan literal string unik (beserta mapping index-nya)
      const uniqueStrings = [];
      const stringMapping = {};
      matches.forEach(str => {
        if (stringMapping.hasOwnProperty(str)) return;
        // Simpan nilai string tanpa pembatas (tanda kutip)
        stringMapping[str] = uniqueStrings.length;
        uniqueStrings.push(str.slice(1, -1));
      });

      // Hasilkan nama acak untuk:
      // - dummyName (misalnya _0x327430)
      // - helperName (misalnya _0x3466)
      // - arrayName (misalnya _0x53a352)
      const dummyName = generateRandomName();
      const helperName = generateRandomName();
      const arrayName = generateRandomName();

      // Lakukan penggantian literal string dalam kode input
      // Gantilah setiap kemunculan literal (berupa keseluruhan kecocokan regex)
      // dengan referensi ke array: misalnya, _0x53a352[<index>]
      let modifiedCode = input;
      // Karena literal string mungkin muncul lebih dari sekali,
      // kita lakukan penggantian untuk tiap literal unik.
      for (const original in stringMapping) {
        const index = stringMapping[original];
        // Escape karakter khusus dalam regex agar aman
        const safeOriginal = original.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
        const pattern = new RegExp(safeOriginal, 'g');
        modifiedCode = modifiedCode.replace(pattern, arrayName + '[' + index + ']');
      }

      // Buat deklarasi array string (dengan setiap elemen di-JSON.stringify agar escape karakter terjaga)
      const arrayDeclaration = 'const ' + arrayName + ' = [' +
        uniqueStrings.map(s => JSON.stringify(s)).join(', ') +
        '];\n';

      // Buat deklarasi dummy dan fungsi pembantu.
      // Contoh format: 
      //   const _0x327430 = _0x3466;
      //   function _0x3466(){ 'use strict'; return; }
      const preamble =
        'const ' + dummyName + ' = ' + helperName + ';\n' +
        'function ' + helperName + '(){\n' +
        '    ' + arrayDeclaration +
        '    // Fungsi pembantu – bisa dikembangkan jika dibutuhkan\n' +
        '    return;\n' +
        '}\n';

      // Gabungkan preamble dan kode yang telah dimodifikasi.
      const finalCode = preamble + modifiedCode;

      document.getElementById("outputCode").textContent = finalCode;
    }
  </script>
</body>
</html>
